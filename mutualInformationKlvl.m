 function obj= mutualInformationKlvl(x)

load noiseParaKlvl.mat

M = length(x)/3;

x1R = x(1);
x1I = x(2);
x2R = x(3);
x2I = x(4);
x3R = x(5);
x3I = x(6);
x4R = x(7);
x4I = x(8);
x5R = x(9);
x5I = x(10);
x6R = x(11);
x6I = x(12);
x7R = x(13);
x7I = x(14);
x8R = x(15);
x8I = x(16);
x9R = x(17);
x9I = x(18);
px1 = x(19);
px2 = x(20);
px3 = x(21);
px4 = x(22);
px5 = x(23);
px6 = x(24);
px7 = x(25);
px8 = x(26);
px9 = x(27);


py11 = px1*W11(x1R+1j*x1I) + ...
       px2*W11(x2R+1j*x2I) + ...
       px3*W11(x3R+1j*x3I) + ...
       px4*W11(x4R+1j*x4I) + ...
       px5*W11(x5R+1j*x5I) + ...
       px6*W11(x6R+1j*x6I) + ...
       px7*W11(x7R+1j*x7I) + ...
       px8*W11(x8R+1j*x8I) + ...
       px9*W11(x9R+1j*x9I);
   
py12 = px1*W12(x1R+1j*x1I) + ...
       px2*W12(x2R+1j*x2I) + ...
       px3*W12(x3R+1j*x3I) + ...
       px4*W12(x4R+1j*x4I) + ...
       px5*W12(x5R+1j*x5I) + ...
       px6*W12(x6R+1j*x6I) + ...
       px7*W12(x7R+1j*x7I) + ...
       px8*W12(x8R+1j*x8I) + ...
       px9*W12(x9R+1j*x9I);
   
py13 = px1*W13(x1R+1j*x1I) + ...
       px2*W13(x2R+1j*x2I) + ...
       px3*W13(x3R+1j*x3I) + ...
       px4*W13(x4R+1j*x4I) + ...
       px5*W13(x5R+1j*x5I) + ...
       px6*W13(x6R+1j*x6I) + ...
       px7*W13(x7R+1j*x7I) + ...
       px8*W13(x8R+1j*x8I) + ...
       px9*W13(x9R+1j*x9I);
   
py21 = px1*W21(x1R+1j*x1I) + ...
       px2*W21(x2R+1j*x2I) + ...
       px3*W21(x3R+1j*x3I) + ...
       px4*W21(x4R+1j*x4I) + ...
       px5*W21(x5R+1j*x5I) + ...
       px6*W21(x6R+1j*x6I) + ...
       px7*W21(x7R+1j*x7I) + ...
       px8*W21(x8R+1j*x8I) + ...
       px9*W21(x9R+1j*x9I);
   
py22 = px1*W22(x1R+1j*x1I) + ...
       px2*W22(x2R+1j*x2I) + ...
       px3*W22(x3R+1j*x3I) + ...
       px4*W22(x4R+1j*x4I) + ...
       px5*W22(x5R+1j*x5I) + ...
       px6*W22(x6R+1j*x6I) + ...
       px7*W22(x7R+1j*x7I) + ...
       px8*W22(x8R+1j*x8I) + ...
       px9*W22(x9R+1j*x9I);

py23 = px1*W23(x1R+1j*x1I) + ...
       px2*W23(x2R+1j*x2I) + ...
       px3*W23(x3R+1j*x3I) + ...
       px4*W23(x4R+1j*x4I) + ...
       px5*W23(x5R+1j*x5I) + ...
       px6*W23(x6R+1j*x6I) + ...
       px7*W23(x7R+1j*x7I) + ...
       px8*W23(x8R+1j*x8I) + ...
       px9*W23(x9R+1j*x9I);
   
py31 = px1*W31(x1R+1j*x1I) + ...
       px2*W31(x2R+1j*x2I) + ...
       px3*W31(x3R+1j*x3I) + ...
       px4*W31(x4R+1j*x4I) + ...
       px5*W31(x5R+1j*x5I) + ...
       px6*W31(x6R+1j*x6I) + ...
       px7*W31(x7R+1j*x7I) + ...
       px8*W31(x8R+1j*x8I) + ...
       px9*W31(x9R+1j*x9I);   
   
py32 = px1*W32(x1R+1j*x1I) + ...
       px2*W32(x2R+1j*x2I) + ...
       px3*W32(x3R+1j*x3I) + ...
       px4*W32(x4R+1j*x4I) + ...
       px5*W32(x5R+1j*x5I) + ...
       px6*W32(x6R+1j*x6I) + ...
       px7*W32(x7R+1j*x7I) + ...
       px8*W32(x8R+1j*x8I) + ...
       px9*W32(x9R+1j*x9I);   
   
py33 = px1*W33(x1R+1j*x1I) + ...
       px2*W33(x2R+1j*x2I) + ...
       px3*W33(x3R+1j*x3I) + ...
       px4*W33(x4R+1j*x4I) + ...
       px5*W33(x5R+1j*x5I) + ...
       px6*W33(x6R+1j*x6I) + ...
       px7*W33(x7R+1j*x7I) + ...
       px8*W33(x8R+1j*x8I) + ...
       px9*W33(x9R+1j*x9I);
   
S11 = W11(x1R+ 1j*x1I)*log(W11(x1R+ 1j*x1I)/py11)*px1 + ...  
      W11(x2R+ 1j*x2I)*log(W11(x2R+ 1j*x2I)/py11)*px2 + ...
      W11(x3R+ 1j*x3I)*log(W11(x3R+ 1j*x3I)/py11)*px3 + ...
      W11(x4R+ 1j*x4I)*log(W11(x4R+ 1j*x4I)/py11)*px4 + ...
      W11(x5R+ 1j*x5I)*log(W11(x5R+ 1j*x5I)/py11)*px5 + ...
      W11(x6R+ 1j*x6I)*log(W11(x6R+ 1j*x6I)/py11)*px6 + ...
      W11(x7R+ 1j*x7I)*log(W11(x7R+ 1j*x7I)/py11)*px7 + ...
      W11(x8R+ 1j*x8I)*log(W11(x8R+ 1j*x8I)/py11)*px8 + ...
      W11(x9R+ 1j*x9I)*log(W11(x9R+ 1j*x9I)/py11)*px9;
  
S12 = W12(x1R+ 1j*x1I)*log(W12(x1R+ 1j*x1I)/py12)*px1 + ...  
      W12(x2R+ 1j*x2I)*log(W12(x2R+ 1j*x2I)/py12)*px2 + ...
      W12(x3R+ 1j*x3I)*log(W12(x3R+ 1j*x3I)/py12)*px3 + ...
      W12(x4R+ 1j*x4I)*log(W12(x4R+ 1j*x4I)/py12)*px4 + ...
      W12(x5R+ 1j*x5I)*log(W12(x5R+ 1j*x5I)/py12)*px5 + ...
      W12(x6R+ 1j*x6I)*log(W12(x6R+ 1j*x6I)/py12)*px6 + ...
      W12(x7R+ 1j*x7I)*log(W12(x7R+ 1j*x7I)/py12)*px7 + ...
      W12(x8R+ 1j*x8I)*log(W12(x8R+ 1j*x8I)/py12)*px8 + ...
      W12(x9R+ 1j*x9I)*log(W12(x9R+ 1j*x9I)/py12)*px9;
  
S13 = W13(x1R+ 1j*x1I)*log(W13(x1R+ 1j*x1I)/py13)*px1 + ...  
      W13(x2R+ 1j*x2I)*log(W13(x2R+ 1j*x2I)/py13)*px2 + ...
      W13(x3R+ 1j*x3I)*log(W13(x3R+ 1j*x3I)/py13)*px3 + ...
      W13(x4R+ 1j*x4I)*log(W13(x4R+ 1j*x4I)/py13)*px4 + ...
      W13(x5R+ 1j*x5I)*log(W13(x5R+ 1j*x5I)/py13)*px5 + ...
      W13(x6R+ 1j*x6I)*log(W13(x6R+ 1j*x6I)/py13)*px6 + ...
      W13(x7R+ 1j*x7I)*log(W13(x7R+ 1j*x7I)/py13)*px7 + ...
      W13(x8R+ 1j*x8I)*log(W13(x8R+ 1j*x8I)/py13)*px8 + ...
      W13(x9R+ 1j*x9I)*log(W13(x9R+ 1j*x9I)/py13)*px9;
  
S21 = W21(x1R+ 1j*x1I)*log(W21(x1R+ 1j*x1I)/py21)*px1 + ...  
      W21(x2R+ 1j*x2I)*log(W21(x2R+ 1j*x2I)/py21)*px2 + ...
      W21(x3R+ 1j*x3I)*log(W21(x3R+ 1j*x3I)/py21)*px3 + ...
      W21(x4R+ 1j*x4I)*log(W21(x4R+ 1j*x4I)/py21)*px4 + ...
      W21(x5R+ 1j*x5I)*log(W21(x5R+ 1j*x5I)/py21)*px5 + ...
      W21(x6R+ 1j*x6I)*log(W21(x6R+ 1j*x6I)/py21)*px6 + ...
      W21(x7R+ 1j*x7I)*log(W21(x7R+ 1j*x7I)/py21)*px7 + ...
      W21(x8R+ 1j*x8I)*log(W21(x8R+ 1j*x8I)/py21)*px8 + ...
      W21(x9R+ 1j*x9I)*log(W21(x9R+ 1j*x9I)/py21)*px9;

S22 = W22(x1R+ 1j*x1I)*log(W22(x1R+ 1j*x1I)/py22)*px1 + ...  
      W22(x2R+ 1j*x2I)*log(W22(x2R+ 1j*x2I)/py22)*px2 + ...
      W22(x3R+ 1j*x3I)*log(W22(x3R+ 1j*x3I)/py22)*px3 + ...
      W22(x4R+ 1j*x4I)*log(W22(x4R+ 1j*x4I)/py22)*px4 + ...
      W22(x5R+ 1j*x5I)*log(W22(x5R+ 1j*x5I)/py22)*px5 + ...
      W22(x6R+ 1j*x6I)*log(W22(x6R+ 1j*x6I)/py22)*px6 + ...
      W22(x7R+ 1j*x7I)*log(W22(x7R+ 1j*x7I)/py22)*px7 + ...
      W22(x8R+ 1j*x8I)*log(W22(x8R+ 1j*x8I)/py22)*px8 + ...
      W22(x9R+ 1j*x9I)*log(W22(x9R+ 1j*x9I)/py22)*px9;

S23 = W23(x1R+ 1j*x1I)*log(W23(x1R+ 1j*x1I)/py23)*px1 + ...  
      W23(x2R+ 1j*x2I)*log(W23(x2R+ 1j*x2I)/py23)*px2 + ...
      W23(x3R+ 1j*x3I)*log(W23(x3R+ 1j*x3I)/py23)*px3 + ...
      W23(x4R+ 1j*x4I)*log(W23(x4R+ 1j*x4I)/py23)*px4 + ...
      W23(x5R+ 1j*x5I)*log(W23(x5R+ 1j*x5I)/py23)*px5 + ...
      W23(x6R+ 1j*x6I)*log(W23(x6R+ 1j*x6I)/py23)*px6 + ...
      W23(x7R+ 1j*x7I)*log(W23(x7R+ 1j*x7I)/py23)*px7 + ...
      W23(x8R+ 1j*x8I)*log(W23(x8R+ 1j*x8I)/py23)*px8 + ...
      W23(x9R+ 1j*x9I)*log(W23(x9R+ 1j*x9I)/py23)*px9;
  
S31 = W31(x1R+ 1j*x1I)*log(W31(x1R+ 1j*x1I)/py31)*px1 + ...  
      W31(x2R+ 1j*x2I)*log(W31(x2R+ 1j*x2I)/py31)*px2 + ...
      W31(x3R+ 1j*x3I)*log(W31(x3R+ 1j*x3I)/py31)*px3 + ...
      W31(x4R+ 1j*x4I)*log(W31(x4R+ 1j*x4I)/py31)*px4 + ...
      W31(x5R+ 1j*x5I)*log(W31(x5R+ 1j*x5I)/py31)*px5 + ...
      W31(x6R+ 1j*x6I)*log(W31(x6R+ 1j*x6I)/py31)*px6 + ...
      W31(x7R+ 1j*x7I)*log(W31(x7R+ 1j*x7I)/py31)*px7 + ...
      W31(x8R+ 1j*x8I)*log(W31(x8R+ 1j*x8I)/py31)*px8 + ...
      W31(x9R+ 1j*x9I)*log(W31(x9R+ 1j*x9I)/py31)*px9;
  
S32 = W32(x1R+ 1j*x1I)*log(W32(x1R+ 1j*x1I)/py32)*px1 + ...  
      W32(x2R+ 1j*x2I)*log(W32(x2R+ 1j*x2I)/py32)*px2 + ...
      W32(x3R+ 1j*x3I)*log(W32(x3R+ 1j*x3I)/py32)*px3 + ...
      W32(x4R+ 1j*x4I)*log(W32(x4R+ 1j*x4I)/py32)*px4 + ...
      W32(x5R+ 1j*x5I)*log(W32(x5R+ 1j*x5I)/py32)*px5 + ...
      W32(x6R+ 1j*x6I)*log(W32(x6R+ 1j*x6I)/py32)*px6 + ...
      W32(x7R+ 1j*x7I)*log(W32(x7R+ 1j*x7I)/py32)*px7 + ...
      W32(x8R+ 1j*x8I)*log(W32(x8R+ 1j*x8I)/py32)*px8 + ...
      W32(x9R+ 1j*x9I)*log(W32(x9R+ 1j*x9I)/py32)*px9;
  
S33 = W33(x1R+ 1j*x1I)*log(W33(x1R+ 1j*x1I)/py33)*px1 + ...  
      W33(x2R+ 1j*x2I)*log(W33(x2R+ 1j*x2I)/py33)*px2 + ...
      W33(x3R+ 1j*x3I)*log(W33(x3R+ 1j*x3I)/py33)*px3 + ...
      W33(x4R+ 1j*x4I)*log(W33(x4R+ 1j*x4I)/py33)*px4 + ...
      W33(x5R+ 1j*x5I)*log(W33(x5R+ 1j*x5I)/py33)*px5 + ...
      W33(x6R+ 1j*x6I)*log(W33(x6R+ 1j*x6I)/py33)*px6 + ...
      W33(x7R+ 1j*x7I)*log(W33(x7R+ 1j*x7I)/py33)*px7 + ...
      W33(x8R+ 1j*x8I)*log(W33(x8R+ 1j*x8I)/py33)*px8 + ...
      W33(x9R+ 1j*x9I)*log(W33(x9R+ 1j*x9I)/py33)*px9;  

objb = S11 + S12 + S13 + ...
       S21 + S22 + S23 + ...
       S31 + S32 + S33;

obj = - objb;
  

